{:source "fighter.txt", :tests [{:line 6, :description "Fighter consumes fuel when moving over non-city terrain.", :givens [{:type :map, :target :game-map, :rows ["F~="]} {:type :unit-props, :unit "F", :props {:fuel 32}} {:type :waiting-for-input, :unit "F", :set-mode true}], :whens [{:type :key-press, :key :D, :input-fn :key-down}], :thens [{:type :unrecognized, :text "THEN after two moves F will be at =."} {:type :unit-prop, :unit "F", :property :fuel, :expected 30} {:type :unit-waiting-for-input, :unit "F"} {:type :message-contains, :area :attention, :config-key :hit-edge}]} {:line 21, :description "Fighter refuels at player city.", :givens [{:type :map, :target :game-map, :rows ["FO"]} {:type :unit-props, :unit "F", :props {:fuel 10}} {:type :waiting-for-input, :unit "F", :set-mode true}], :whens [{:type :key-press, :key :d, :input-fn :handle-key}], :thens [{:type :container-prop, :target "O", :property :fighter-count, :expected 1, :lookup :city} {:type :unit-absent, :unit "F"}]} {:line 33, :description "Fighter bingo wakes when fuel low and city nearby.", :givens [{:type :map, :target :game-map, :rows ["OF"]} {:type :unit-props, :unit "F", :props {:mode :sentry, :fuel 9}}], :whens [{:type :start-new-round}], :thens [{:type :unit-prop, :unit "F", :property :mode, :expected :awake} {:type :message-contains, :area :attention, :config-key :fighter-bingo}]} {:line 45, :description "Fighter out of fuel wakes.", :givens [{:type :map, :target :game-map, :rows ["#F"]} {:type :unit-props, :unit "F", :props {:mode :sentry, :fuel 2}}], :whens [{:type :start-new-round}], :thens [{:type :unit-waiting-for-input, :unit "F"} {:type :message-contains, :area :attention, :config-key :fighter-out-of-fuel}]} {:line 57, :description "Fighter crashes when fuel reaches zero.", :givens [{:type :map, :target :game-map, :rows ["#F"]} {:type :unit-props, :unit "F", :props {:mode :sentry, :fuel 1}}], :whens [{:type :start-new-round}], :thens [{:type :unit-absent, :unit "F"} {:type :message-contains, :area :error, :config-key :fighter-crashed}]} {:line 69, :description "Fighter lands on carrier.", :givens [{:type :map, :target :game-map, :rows ["FC"]} {:type :container-state, :target "C", :props {:fighter-count 0}} {:type :waiting-for-input, :unit "F", :set-mode true}], :whens [{:type :key-press, :key :d, :input-fn :handle-key}], :thens [{:type :container-prop, :target "C", :property :fighter-count, :expected 1, :lookup :unit} {:type :unit-absent, :unit "F"}]} {:line 82, :description "Fighter launched from airport.", :givens [{:type :map, :target :game-map, :rows ["O%"]} {:type :container-state, :target "O", :props {:fighter-count 1, :awake-fighters 1}} {:type :waiting-for-input, :unit "O", :set-mode true}], :whens [{:type :key-press, :key :d, :input-fn :handle-key}], :thens [{:type :unit-present, :unit "F", :target "%"} {:type :container-prop, :target "O", :property :fighter-count, :expected 0, :lookup :city}]} {:line 95, :description "Fighter attention shows fuel.", :givens [{:type :map, :target :game-map, :rows ["F#"]} {:type :unit-props, :unit "F", :props {:fuel 20}} {:type :waiting-for-input, :unit "F", :set-mode true}], :whens [], :thens [{:type :message-contains, :area :attention, :text "fuel:20"}]} {:line 105, :description "Fighter speed is 8 per round.", :givens [{:type :map, :target :game-map, :rows ["F~~~~~~~~=~"]} {:type :waiting-for-input, :unit "F", :set-mode true}], :whens [{:type :key-press, :key :D, :input-fn :key-down}], :thens [{:type :unit-at-next-round, :unit "F", :target "="}]}]}